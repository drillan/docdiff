# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

docdiffã¯ã€MyST/reStructuredTextãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å¤šè¨€èªžç¿»è¨³ç®¡ç†ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚æ–‡æ›¸ã‚’æ§‹é€ å˜ä½ã§è§£æžã—ã€ç¿»è¨³çŠ¶æ…‹ã‚’è¿½è·¡ã™ã‚‹ã“ã¨ã§ã€æŠ€è¡“ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å›½éš›åŒ–ã‚’æ”¯æ´ã—ã¾ã™ã€‚

## é–‹ç™ºã‚³ãƒžãƒ³ãƒ‰

### ä¾å­˜é–¢ä¿‚ç®¡ç†ã¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« (uvã‚’ä½¿ç”¨)
uv sync

# é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
uv pip install -e .

# CLIãƒ„ãƒ¼ãƒ«ã®å®Ÿè¡Œ
uv run docdiff
```

### Sphinxãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ“ãƒ«ãƒ‰
```bash
# è‹±èªžãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ“ãƒ«ãƒ‰
uv run sphinx-build -M html docs/en/ docs/en/_build/

# ãƒ“ãƒ«ãƒ‰çµæžœã®ç¢ºèª
open docs/en/_build/html/index.html
```

### Pythonå“è³ªãƒã‚§ãƒƒã‚¯
```bash
# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ
uv run ruff format .

# ãƒªãƒ³ãƒˆãƒã‚§ãƒƒã‚¯ã¨è‡ªå‹•ä¿®æ­£
uv run ruff check . --fix

# åž‹ãƒã‚§ãƒƒã‚¯
uv run mypy .

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
uv run pytest tests/

# å…¨å“è³ªãƒã‚§ãƒƒã‚¯ã‚’ä¸€æ‹¬å®Ÿè¡Œ
uv run ruff format . && uv run ruff check . --fix && uv run mypy . && uv run pytest tests/
```

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚³ã‚¢è¨­è¨ˆæ€æƒ³
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æŽ¡ç”¨
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è«–ç†çš„æ§‹é€ å˜ä½ï¼ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã€å›³è¡¨ãªã©ï¼‰ã§åˆ†é›¢
- æ–‡å­—æ•°ã«ã‚ˆã‚‹æ©Ÿæ¢°çš„ãªåˆ†å‰²ã¯è¡Œã‚ãªã„
- å„æ§‹é€ è¦ç´ ã®ç¿»è¨³çŠ¶æ…‹ã‚’ç®¡ç†ï¼ˆpending/translated/reviewed/outdatedï¼‰

### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆè¨ˆç”»ä¸­ï¼‰
- **DocumentParser**: MyST/reStructuredTextæ–‡æ›¸ã®æ§‹é€ è§£æž
- **StructureDB**: è§£æžæ¸ˆã¿æ§‹é€ ã®æ°¸ç¶šåŒ–ã¨ã‚¯ã‚¨ãƒª
- **ReferenceTracker**: ç›¸äº’å‚ç…§ã®è¿½è·¡ã¨ç®¡ç†
- **TranslationState**: ç¿»è¨³çŠ¶æ…‹ã®ç®¡ç†

### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- Python 3.12+
- Typer (CLI framework)
- Pydantic (ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«)
- Sphinx (ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‡¦ç†)
- myst-parser (MySTå½¢å¼ã®ãƒ‘ãƒ¼ã‚¹)

## é–‹ç™ºæŒ‡é‡

### ðŸš€ ç ´å£Šçš„å¤‰æ›´ã®æŽ¨å¥¨ï¼ˆé‡è¦ï¼‰

**æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã„æ–°è¦é–‹ç™ºã®ãŸã‚ã€ä»¥ä¸‹ã®æ–¹é‡ã‚’åŽ³å®ˆã™ã‚‹ï¼š**

#### å¾Œæ–¹äº’æ›æ€§ã®æŽ’é™¤
- æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã„ãªã„ãŸã‚ã€å¾Œæ–¹äº’æ›æ€§ã®è€ƒæ…®ã¯ä¸€åˆ‡ä¸è¦
- ãƒ‡ãƒ¼ã‚¿ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ç§»è¡Œãƒ‘ã‚¹ã®å®Ÿè£…ã‚’åŽ³ç¦ã¨ã™ã‚‹
- ã‚ˆã‚Šè‰¯ã„è¨­è¨ˆã®ãŸã‚ã®ç ´å£Šçš„å¤‰æ›´ã‚’ç©æ¥µçš„ã«æŽ¨å¥¨
- APIã‚„ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å¤‰æ›´æ™‚ã«äº’æ›æ€§ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œã‚‰ãªã„

#### ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ¼ãƒ‰æŽ’é™¤ã®åŽŸå‰‡
- éžæŽ¨å¥¨ï¼ˆdeprecatedï¼‰ã‚³ãƒ¼ãƒ‰ã®ç¶­æŒã‚’ç¦æ­¢
- äº’æ›æ€§ã®ãŸã‚ã®ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚„ãƒ©ãƒƒãƒ‘ãƒ¼ã®å®Ÿè£…ã‚’ç¦æ­¢
- å¸¸ã«æœ€æ–°ãƒ»æœ€é©ãªå®Ÿè£…ã®ã¿ã‚’ä¿æŒ
- ä¸è¦ã«ãªã£ãŸã‚³ãƒ¼ãƒ‰ã¯å³åº§ã«å‰Šé™¤ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚‚ç¦æ­¢ï¼‰
- ã€Œå°†æ¥ã®ãŸã‚ã€ã€Œå¿µã®ãŸã‚ã€ã®ã‚³ãƒ¼ãƒ‰ä¿æŒã‚’ç¦æ­¢

#### ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ç¶­æŒ
- æŠ€è¡“çš„è² å‚µã‚’ã‚¼ãƒ­ã«ä¿ã¤
- å®Ÿé¨“çš„ã‚³ãƒ¼ãƒ‰ã¯åˆ¥ãƒ–ãƒ©ãƒ³ãƒã§ç®¡ç†ã—ã€mainãƒ–ãƒ©ãƒ³ãƒã«ã¯æŒã¡è¾¼ã¾ãªã„
- ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã¯éŽåŽ»ã®å®Ÿè£…ã‚’å®Œå…¨ã«ç½®ãæ›ãˆã‚‹
- å¤ã„å®Ÿè£…ã¨ã®å…±å­˜æœŸé–“ã‚’è¨­ã‘ãªã„
- ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã¯å¸¸ã«ã€Œä»Šæ›¸ããªã‚‰ã“ã†æ›¸ãã€çŠ¶æ…‹ã‚’ç¶­æŒ

#### å®Ÿè£…åˆ¤æ–­ã®å„ªå…ˆé †ä½
1. **æœ€é©æ€§** - ç¾æ™‚ç‚¹ã§æœ€ã‚‚è‰¯ã„å®Ÿè£…ã‚’é¸æŠž
2. **ç°¡æ½”æ€§** - ã‚·ãƒ³ãƒ—ãƒ«ã§ç†è§£ã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰
3. **ä¿å®ˆæ€§** - å°†æ¥ã®å¤‰æ›´ãŒå®¹æ˜“ãªè¨­è¨ˆ
4. ~~äº’æ›æ€§~~ - **è€ƒæ…®ä¸è¦**

**ã“ã®æ–¹é‡ã«ã‚ˆã‚Šã€å¸¸ã«æœ€æ–°ãƒ»æœ€é©ãªã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚’ç¶­æŒã—ã€é–‹ç™ºé€Ÿåº¦ã¨å“è³ªã‚’æœ€å¤§åŒ–ã™ã‚‹ã€‚**

### ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«
- Python 3.12ä»¥ä¸Šã®æ©Ÿèƒ½ã‚’æ´»ç”¨
- åž‹ãƒ’ãƒ³ãƒˆã‚’å¿…é ˆã¨ã™ã‚‹
- Pydanticãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿æ¤œè¨¼

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹é€ ã®æ‰±ã„
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ©ãƒ™ãƒªãƒ³ã‚°ï¼ˆ`:name:`ï¼‰ã‚’ä¿æŒ
- ãƒ–ãƒ­ãƒƒã‚¯è¦ç´ ã®`caption`ã‚„nameå±žæ€§ã‚’ç¶­æŒ
- Sphinxã®ç›¸äº’å‚ç…§ã‚·ã‚¹ãƒ†ãƒ ã«å¯¾å¿œ

### ç¿»è¨³ç®¡ç†ã®åŽŸå‰‡
- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å¤‰æ›´ã¯ãƒãƒƒã‚·ãƒ¥ãƒ™ãƒ¼ã‚¹ã§æ¤œçŸ¥
- å¢—åˆ†æ›´æ–°ã«å¯¾å¿œ
- ç¿»è¨³å˜ä½ã¯è«–ç†çš„ãªæ–‡æ›¸æ§‹é€ ã«åŸºã¥ã
- Pythonã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ã‚³ãƒ¡ãƒ³ãƒˆã¯å…¨ã¦è‹±èªžã§è¨˜è¿°ã™ã‚‹

### Git ã‚³ãƒŸãƒƒãƒˆè¦å‰‡
- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å¿…ãšè‹±èªžã§è¨˜è¿°ã™ã‚‹
- Conventional Commitså½¢å¼ã«æº–æ‹ : `[type]: [summary]`
- ä½¿ç”¨å¯èƒ½ãªã‚¿ã‚¤ãƒ—:
  - `feat`: æ–°æ©Ÿèƒ½è¿½åŠ 
  - `fix`: ãƒã‚°ä¿®æ­£
  - `docs`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå¤‰æ›´
  - `style`: ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ã®å¤‰æ›´ï¼ˆå‹•ä½œã«å½±éŸ¿ã—ãªã„ï¼‰
  - `refactor`: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
  - `test`: ãƒ†ã‚¹ãƒˆã®è¿½åŠ ãƒ»ä¿®æ­£
  - `chore`: ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã‚„ãƒ„ãƒ¼ãƒ«ã®å¤‰æ›´

## Pythonå“è³ªç®¡ç†

### å“è³ªåŸºæº–
æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ä»¥ä¸‹ã®å“è³ªåŸºæº–ã‚’åŽ³å®ˆã—ã¾ã™ï¼š

#### å¿…é ˆåŸºæº–ï¼ˆãƒžãƒ¼ã‚¸ãƒ–ãƒ­ãƒƒã‚«ãƒ¼ï¼‰
- ruffã‚¨ãƒ©ãƒ¼: 0ä»¶
- mypyåž‹ã‚¨ãƒ©ãƒ¼: 0ä»¶
- ãƒ†ã‚¹ãƒˆæˆåŠŸçŽ‡: 100%
- æ§‹æ–‡ã‚¨ãƒ©ãƒ¼: 0ä»¶

#### æŽ¨å¥¨åŸºæº–
- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸: > 80%
- åž‹ã‚¢ãƒŽãƒ†ãƒ¼ã‚·ãƒ§ãƒ³çŽ‡: 100%
- docstringè¨˜è¼‰çŽ‡: > 90%
- è¤‡é›‘åº¦ã‚¹ã‚³ã‚¢: < 10

### å“è³ªãƒã‚§ãƒƒã‚¯è‡ªå‹•åŒ–
ã‚³ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã¯å¿…ãšå“è³ªãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã€ã™ã¹ã¦ã®ã‚¨ãƒ©ãƒ¼ã‚’ã‚¼ãƒ­ã«ã—ã¦ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆã—ã¦ãã ã•ã„ã€‚
è©³ç´°ãªå“è³ªãƒã‚§ãƒƒã‚¯æ‰‹é †ã¨ã‚¨ãƒ©ãƒ¼è‡ªå‹•ä¿®æ­£ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ï¼š

**@.claude/commands/python-quality-check.md**

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¯ä»¥ä¸‹ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼š
- å®Œå…¨è‡ªå‹•åŒ–ã•ã‚ŒãŸå“è³ªãƒã‚§ãƒƒã‚¯ãƒ•ãƒ­ãƒ¼
- ã‚¨ãƒ©ãƒ¼æ¤œå‡ºæ™‚ã®è‡ªå‹•ä¿®æ­£ãƒ«ãƒ¼ãƒ—
- å„ç¨®ã‚¨ãƒ©ãƒ¼ã®å…·ä½“çš„ãªå¯¾å‡¦æ³•
- ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰

### ã‚³ãƒŸãƒƒãƒˆå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
```bash
# ã‚³ãƒŸãƒƒãƒˆå‰ã®å¿…é ˆãƒã‚§ãƒƒã‚¯
echo "ã‚³ãƒŸãƒƒãƒˆå‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ:"
echo -n "1. ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆå®Œäº†: "; uv run ruff format . --check && echo "âœ“" || echo "âœ—"
echo -n "2. ãƒªãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ãªã—: "; uv run ruff check . --quiet && echo "âœ“" || echo "âœ—"
echo -n "3. åž‹ãƒã‚§ãƒƒã‚¯é€šéŽ: "; uv run mypy . --no-error-summary 2>/dev/null && echo "âœ“" || echo "âœ—"
echo -n "4. ãƒ†ã‚¹ãƒˆå…¨é€šéŽ: "; uv run pytest tests/ -q 2>/dev/null && echo "âœ“" || echo "âœ—"
```